<?phpheader('Content-Type:text/xml');echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>";// This API is used to list all the softwares in the software register along with the number of licenses that have been purchased for each of them.// oa_audit_information.php?key=abcd&hostname=lptp-johnfunction invalid(){	echo "<node>";		echo "<count>invalid</count>";	echo "</node>";	die(0);}function success($count){	echo "<node>";		echo "<count>".$count."</count>";	echo "</node>";	die(0);}function showxml($result, $num_rows){if($num_rows>0){			echo "<node>";			while($row = mysql_fetch_array($result)){								$hostname=$row[0];				$last_seen=$row[1];/*				$year 	= substr($last_seen,0,4);				$month	= substr($last_seen,5,2);				$day	= substr($last_seen,6,2);				$last_seen=mktime(0,0,0,$month,$day,$year);	*/						echo "<host>";					echo "<hostname>".$hostname."</hostname>";					echo "<last_audited>".$last_seen."</last_audited>";				echo "</host>";			}			echo "</node>";		}else{			$nodata = 0;			success($nodata);		}}// include config file, also contains the API KEYrequire_once('../include/config.php');require_once('../include/dboa.php');$api_key		= strip_tags($_REQUEST['key']);$hostname		= strip_tags($_REQUEST['hostname']);$num_rows		= '';// validate api keyif($api_key!=$API_KEY || $api_key==''){	invalid();}else{		$sql = "SELECT hostname,UNIX_TIMESTAMP(last_seen) FROM system WHERE hostname='$hostname'";		$result = mysql_query($sql);				$num_rows = mysql_num_rows($result);		showxml($result, $num_rows);}?>