<?phpheader('Content-Type:text/xml');echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>";// This API is used to list all hosts that are active.// Hosts refer to desktops, laptops and servers// ast_list_active_hosts.php?key=abcd&status=1// Passing No status parameters returns systems with both active and in-active states.function invalid(){	echo "<node>";		echo "<count>invalid</count>";	echo "</node>";	die(0);}function success($count){	echo "<node>";		echo "<count>".$count."</count>";	echo "</node>";	die(0);}function showxml($result, $num_rows){if($num_rows>0){			echo "<node>";			while($row = mysql_fetch_array($result)){				echo "<asset>";					echo "<tag>".$row[0]."</tag>";					echo "<category>".$row[1]."</category>";					echo "<model>".$row[2]."</model>";					echo "<serialno>".$row[3]."</serialno>";										echo "<assignedto>".$row[4]." ".$row[5]."</assignedto>";					echo "<hostname>".$row[6]."</hostname>";				echo "</asset>";			}			echo "</node>";		}else{			$nodata = 0;			success($nodata);		}}// include config file, also contains the API KEYrequire_once('../include/config.php');require_once('../include/db.php');$api_key		= strip_tags($_REQUEST['key']);$status			= strip_tags($_REQUEST['status']);$num_rows		= '';// validate api keyif($api_key!=$API_KEY || $api_key==''){	invalid();}else{		$sql = "SELECT a.assetid,b.assetcategory,a.model,a.serialno,d.first_name,d.last_name,a.hostname FROM asset a,assetcategory b,assetstatus c, user_master d WHERE a.assetcategoryid=b.assetcategoryid AND a.statusid=c.statusid AND a.employee=d.username and a.assetcategoryid in (1,2,19,20) and a.auditstatus='1'";		if (strlen($status)==0){			$sql.="  and a.statusid in (1,2)";		}else{			$sql.="  and a.statusid=$status";		}		$sql.=" order by a.hostname";		$result = mysql_query($sql);		$num_rows = mysql_num_rows($result);		showxml($result, $num_rows);}?>